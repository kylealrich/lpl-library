ExternalEntityCustomerPortalRegistration is a Form
    title is "Registration"
    disable field options
    disable all actions
    Layout
        visible when (not TransientSendVerificationCode)
            header2 of "EnterLoginInformation"
            single column
                EmailAddress
                    label is "*_Email_Address_(User_Name)"
                    when value changed
                        LoginName =  EmailAddress
                        refresh DisplayForVerification
                        refresh CustomerRepresentativeContactByEmailExists
                        refresh EmailAddressEntered
                        refresh EmailAddressNotEntered
                paragraph
                    text of "Don't_have_an_email_address?_Create_one_here:"
                    button of "CreateEmailAddress"
                        link is external "<CustomerGroup.CustomerEmailHelpLink>"
                        display as link
                RegistrationPassword
                    label is "*_Password"
                    when value changed
                        refresh RegistrationPasswordEntered
                        refresh RegistrationPasswordNotEntered
                RegistrationConfirmPassword
                    label is "*_ConfirmPassword"
                    when value changed
                        refresh RegistrationConfirmPasswordEntered
                        refresh RegistrationConfirmPasswordNotEntered
                TransientDisplayPasswordPolicy
                    label is "Show_Password_Requirements"
                    display as switch
                visible when (TransientDisplayPasswordPolicy)
                    CustomerGroup.DerivedPasswordPolicy
                        no label
                        display as text
            blank line
            header2 of "EnterInformationAboutYourself"
            single column
                MainContact.GivenName
                    label is "*_FirstName"
                    when value changed
                        refresh MainContactGivenNameEntered
                        refresh MainContactGivenNameNotEntered
                MainContact.FamilyName
                    label is "*_LastName"
                    when value changed
                        refresh MainContactFamilyNameEntered
                        refresh MainContactFamilyNameNotEntered
            paragraph
                TelephoneNumber.InternationalPrefix
                    label is "*_PhoneNumber"
                TelephoneNumber.SubscriberNumber
                    no label
                    when value changed
                        refresh TelephoneNumberEntered
                        refresh TelephoneNumberNotEntered
                TelephoneNumber.Extension
                    label is "Ext"
                text of "(InternationalPrefix,PhoneNumber,Extension)"
                    italics
            blank line
            header2 of "EnterInformationAboutYourCompany"
            single column
                CustomerName
                    label is "*_CompanyName"
                    when value changed
                        refresh CustomerNameEntered
                        refresh CustomerNameNotEntered
                DunAndBradstreetNumber
                    label is "Dun&Bradstreet"
            single column
                TaxIdGroup.TaxIdType
                    label is "*_TaxIDType"
                    when value changed
                        refresh TaxIdTypeEntered
                        refresh TaxIdTypeNotEntered
            paragraph
                TaxIdGroup.TaxId
                    label is "*_TaxID"
                    when value changed
                        refresh TaxIdEntered
                        refresh TaxIdNotEntered
                text of "<TaxIdHelpText>"
                    italics
            blank line
            header5 of "MailingAddress"
            MailingAddress
                form is PostalAddressMinimum
            single column
                text of "*__=_Required"
            visible when (not DisplayForVerification)
                paragraph centered
                    DerivedBlankField5
                        no label
                        display as text
                paragraph centered
                    captcha control
                paragraph centered
                    button of "Submit"
                        action is save
                        is primary
            visible when (DisplayForVerification)
                paragraph centered
                    button of "Submit"
                        is primary
                        when button pressed
                            TransientStringHolder =  blank
                            refresh AcceptTerms
                            refresh AcceptTermsEntered
                            refresh AcceptTermsNotEntered
                            refresh MailingAddressCounrtyEntered
                            refresh MailingAddressCountryNotEntered
                            refresh MailingAddressEntered
                            refresh MailingAddressNotEntered
                            refresh RegistrationPasswordsDoNotMatch
                            refresh TransientErrorOccurred
                            refresh RequiredRegistrationFieldsEntered
                            refresh RequiredRegistrationFieldsNotEntered
                            refresh MainContact.GivenName
                            refresh MainContact.FamilyName
                            refresh DerivedVerificationCodeRequiredRegistration
                            refresh EmailAddress
                            refresh TransientSendVerificationCode
                            refresh TransientNextAction
                            refresh TransientUserVerificationId
                            refresh TransientUserIdentity
                            refresh TransientUserRegistered
                            refresh TransientStringHolder
                            TransientErrorOccurred =  false
                                when (RequiredRegistrationFieldsEntered)
                            TransientErrorOccurred =  false
                                when (TransientUserRegistered)
                            TransientErrorOccurred =  true
                                when (RequiredRegistrationFieldsNotEntered)
                            TransientErrorOccurred =  true
                                when (not TransientUserRegistered)
                            TransientSendVerificationCode =  true
                                when (not TransientErrorOccurred)
                visible when (TransientErrorOccurred)
                    visible when (EmailAddressNotEntered)
                        paragraph centered
                            text of "<EmailAddressRequiredMessage>"
                                header4
                                color of red
                    visible when (RegistrationPasswordNotEntered)
                        paragraph centered
                            text of "<PasswordRequiredMessage>"
                                header4
                                color of red
                    visible when (RegistrationConfirmPasswordNotEntered)
                        paragraph centered
                            text of "<ConfirmPasswordRequiredMessage>"
                                header4
                                color of red
                    visible when (RegistrationPasswordsDoNotMatch)
                        paragraph centered
                            text of "<PasswordsDoNotMatchMessage>"
                                header4
                                color of red
                    visible when (MainContactGivenNameNotEntered)
                        paragraph centered
                            text of "<FirstNameRequiredMessage>"
                                header4
                                color of red
                    visible when (MainContactFamilyNameNotEntered)
                        paragraph centered
                            text of "<LastNameRequiredMessage>"
                                header4
                                color of red
                    visible when (TelephoneNumberNotEntered)
                        paragraph centered
                            text of "<TelephoneNumberRequiredMessage>"
                                header4
                                color of red
                    visible when (CustomerNameNotEntered)
                        paragraph centered
                            text of "<CompanyNameRequiredMessage>"
                                header4
                                color of red
                    visible when (TaxIdTypeNotEntered)
                        paragraph centered
                            text of "<TaxIdTypeRequiredMessage>"
                                header4
                                color of red
                    visible when (TaxIdNotEntered)
                        paragraph centered
                            text of "<TaxIdRequiredMessage>"
                                header4
                                color of red
                    visible when (MailingAddressCountryNotEntered)
                        paragraph centered
                            text of "<CountryJurisdictionRequiredMessage>"
                                header4
                                color of red
                    visible when (MailingAddressNotEntered)
                        paragraph centered
                            text of "<MailingAddressRequiredMessage>"
                                header4
                                color of red
                    visible when (AcceptTermsNotEntered)
                        paragraph centered
                            text of "<MustAcceptTermsAndConditionsMessage>"
                                header4
                                color of red
                    paragraph centered
                        TransientStringHolder
                            no label
                            color of red
                            display as text
        visible when (TransientSendVerificationCode)
            paragraph centered
                text of "PleaseEnterTheVerificationCodeThatWasSentToTheBelowEmailAddress"
                    bold
                    italics
            visible when (TransientResendVerificationCode)
                paragraph centered
                    text of "WeHaveSentANewVerificationCodeTo:"
                        header4
                        color of red
            paragraph centered
                EmailAddress
                    no label
                    display as text
            blank line
            paragraph centered
                TransientVerificationCode
                    label is "EnterVerificationCode"
            paragraph centered
                button of "ResendVerificationCode"
                    display as link
                    is primary
                    when button pressed
                        TransientVerificationCodeResent =  false
                        refresh TransientVerificationCodeResent
                        refresh TransientUserIdentity
                        refresh TransientUserVerificationId
                        refresh DerivedResendVerificationCode
                        refresh TransientResendVerificationCode
            paragraph centered
                button of "ReturnToRegistration"
                    display as link
                    is primary
                    when button pressed
                        TransientSendVerificationCode =  false
                        TransientResendVerificationCode =  false
                        TransientErrorOccurred =  false
                        TransientStringHolder =  blank
            paragraph centered
                DerivedBlankField5
                    no label
                    display as text
            paragraph centered
                captcha control
            paragraph centered
                button of "Submit"
                    action is save
                    is primary
            paragraph centered
                TransientStringHolder
                    no label
                    color of red
                    display as text
            visible when (false)
                AcceptTerms
                AcceptTermsEntered
                RegistrationPasswordsDoNotMatch
                EmailAddressEntered
                RegistrationPasswordEntered
                RegistrationConfirmPasswordEntered
                MainContactGivenNameEntered
                MainContactFamilyNameEntered
                TelephoneNumberEntered
                CustomerNameEntered
                TaxIdTypeEntered
                TaxIdEntered
                MailingAddressCounrtyEntered
                MailingAddressEntered
                LoginName
                DerivedVerificationCodeRequiredRegistration
                TransientSendVerificationCode
                TransientResendVerificationCode
                DerivedResendVerificationCode
                DerivedVerificationCodeRequired
                DisplayForVerification
                TransientUserRegistered
                CustomerRepresentative
                TransientNextAction
                TransientUserVerificationId
                TransientUserIdentity
                CustomerRepresentativeContactByEmailExists
                TransientErrorOccurred
                TransientStringHolder
                TransientVerificationCodeResent
