RegisterMFADevice is an ActionForm
    action is RegisterMFADevice
    title is "_"
    disable field options
    called out actions only
    suppress standard toolbar
    Layout
        text of "Add_Device_For_Multifactor_Authentication"
            header2
        visible when (not ExternalEntity.MFATotp)
            visible when (not MFAEmailDeviceRegisterionEnabled)
                text of "An_email_<RegisteredEmailDevice>_has_already_been_registered_for_MFA."
                text of "Click_on_the_submit_button_to_remove_the_registered_email_device."
        visible when (ExternalEntity.MFAEnable)
            visible when (ErrorMessage entered)
                text of "<ErrorMessage>"
                    color of red
            visible when (DeviceType not entered)
                visible when (AllowMFARegistration)
                    DeviceType
                        label is "PleaseSelectAPreferredContactMethod"
                        display as radio buttons
                        when value changed
                            refresh DeviceRegistrationQRCode
                            refresh DeviceChangeValidation
                            refresh SendMFACodeToDevice
                            refresh MFACodeVerificationSentMessage
                            refresh RegistrationStatus
                            refresh MFACodeSentStatus
                            refresh MFACodeResentStatus
                            refresh MFACodeSentFailedStatus
                            refresh EUReferenceId
                            refresh ErrorMessage
                            refresh QRCodeForMFADevice
                visible when (not MFASupportedForExternalEntity)
                    text of "No_supported_authentication_method_available_to_register_a_device_for_multifactor_authentication."
                    text of "Please_contact_the_system_administrator_for_more_information."
            visible when (DeviceType.Email)
                visible when (HasSelectedEmailIdentifier)
                    EUserIdentifier
                        label is "Email"
                        display as text
                visible when (not HasSelectedEmailIdentifier)
                    EUserIdentifier
                        label is "Email"
                        show up to 50 characters
                        display as required
                        initial value is SelectedEmailIdentifier
                        when value changed
                            MFACode =  blank
                            refresh MFACode
                            refresh SendMFACodeToDevice
                            refresh EUReferenceId
                            refresh MFACodeVerificationSentMessage
                            refresh RegistrationStatus
                            refresh MFACodeSentStatus
                            refresh MFACodeResentStatus
                            refresh MFACodeSentFailedStatus
                button of "ResendVerificationCode"
                    visible when (MFACodeSentStatus)
                    display as link
                    when button pressed
                        refresh ResendMFACodeToDevice
                        refresh RegistrationStatus
                        refresh ErrorMessage
                        refresh EUReferenceId
                        refresh MFACodeSentStatus
                        refresh MFACodeResentStatus
                        refresh MFACodeSentFailedStatus
                visible when (MFACodeResentStatus)
                    text of "NewVerificationCodeSent"
                        bold
                        color of green
                paragraph
                    text of "Please_enter_the_verification_code_sent_to_the_selected_email.The_code_will_expire_in_15_minutes."
                visible when (MFACodeSentStatus)
                    text of "<MFACodeVerificationSentMessage>"
                        bold
                        color of green
                visible when (MFACodeSentFailedStatus)
                    text of "<MFACodeSentEmailFailedMessage>"
                        bold
                        color of red
            visible when (DeviceType.TOTP)
                DeviceName
                    label is "DeviceName"
                    display as required
                    initial value is blank
                single column
                    text of "Download_a_One-\\Time_password_authenticator_application_on_your_mobile_device"
                        left align
                        bullet
                    text of "Follow_the_instructions_provided_in_the_application"
                        left align
                        bullet
                    text of "Choose_the_scan_QR_code_option"
                        left align
                        bullet
                text of "<DeviceRegistrationQRCode>"
            visible when (DeviceType entered)
                MFACode
                    label is "VerificationCode"
                    initial value is blank
            visible when (false)
                RegistrationGUID
                    label is "RegistrationGUID"
                ExternalEntityInfo
                ResendMFACodeToDevice
                SendMFACodeToDevice
                ErrorMessage
                MFACodeVerificationSentMessage
                MFACodeSentStatus
                MFACodeResentStatus
                RegistrationStatus
                MFACodeSentFailedStatus
                DeviceChangeValidation
                DeviceRegistrationQRCode
                InitializationComplete
                ExternalEntityJSON
                    label is "ExternalEntityInfo"
                    initial value is InitializeExternalEntityJSON
                QRCodeForMFADevice
                EUReferenceId
                    label is "EUReferenceId"
