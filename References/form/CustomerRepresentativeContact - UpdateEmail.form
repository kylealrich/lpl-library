UpdateEmail is an ActionForm
    action is UpdateEmail
    title is "UpdateEmailAddress"
    disable field options
    Layout
        single column
            visible when (not TransientSendVerificationCode)
                TransientNewEmailAddress
                    label is "New_Email_Address_(User_Name)"
                TransientEmailPassword
                    label is "CurrentPassword"
            visible when (TransientSendVerificationCode)
                TransientNewEmailAddress
                    label is "New_Email_Address_(User_Name)"
                    display only
                TransientEmailPassword
                    label is "CurrentPassword"
                    display only
            visible when (not TransientSendVerificationCode)
                visible when (DisplayForVerification)
                    paragraph centered
                        text of "ChangingYourEmailAddressWillRequireVerificationOfTheNewEmailAddress."
                            bold
                            italics
                    paragraph centered
                        text of "UseThe_Send_Verification_CodeButtonAfterEnteringYourNewEmailAddressAndCurrentPassword."
                            bold
                            italics
                    paragraph centered
                        button of "SendVerificationCode"
                            is primary
                            when button pressed
                                TransientStringHolder =  blank
                                refresh DerivedVerificationCodeRequiredEmailChange
                                refresh TransientStringHolder
                                refresh TransientUserUpdateInitiated
                                refresh TransientSendVerificationCode
                                refresh TransientNextAction
                                refresh TransientUserVerificationId
                                refresh TransientUserIdentity
                                TransientSendVerificationCode =  true
                                    when (TransientUserUpdateInitiated)
            visible when (TransientSendVerificationCode)
                paragraph centered
                    text of "PleaseEnterTheVerificationCodeThatWasSentToTheNewEmailAddressEnteredAbove"
                        bold
                        italics
                visible when (TransientResendVerificationCode)
                    paragraph centered
                        text of "WeHaveSentANewVerificationCode"
                            header4
                            color of red
                blank line
                paragraph centered
                    TransientVerificationCode
                        no label
                paragraph centered
                    button of "ResendVerificationCode"
                        display as link
                        is primary
                        when button pressed
                            TransientVerificationCodeResent =  false
                            refresh TransientVerificationCodeResent
                            refresh TransientUserUpdateInitiated
                            refresh TransientUserIdentity
                            refresh TransientUserVerificationId
                            refresh DerivedResendVerificationCode
                            refresh TransientResendVerificationCode
            paragraph centered
                TransientStringHolder
                    no label
                    color of red
                    display as text
            visible when (false)
                DerivedVerificationCodeRequiredEmailChange
                TransientNextAction
                TransientUserVerificationId
                TransientUserIdentity
                TransientUserUpdateInitiated
                DerivedResendVerificationCode
                TransientSendVerificationCode
                TransientVerificationCodeResent
