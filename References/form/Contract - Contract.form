Contract is a Form
    restrict action CreateIDMXML
    restrict action DeleteIDMXML
    Layout
        two column distributed
            column1
                visible when (not ContractExists)
                    paragraph
                        ContractGroup
                        ContractGroup.BusinessGroup.Description
                            display as text
                visible when (ContractExists)
                    display as text
                        ContractGroup.RepresentativeText
                            label is "ContractGroup"
                paragraph
                    Contract
                        display as text
                    Name
                    visible when (MultiplePriceProgram)
                        text of "MultiplePriceProgram"
                            bold
                            color of blue
            column2
                visible when (not ContractExists)
                    paragraph
                        Supplier
                        Supplier.SupplierName
                            no label
                            display as text
                visible when (CanEnterSupplier)
                    paragraph
                        Supplier
                        Supplier.SupplierName
                            no label
                            display as text
                paragraph
                    SupplierSourceId
                        label is "SupplierContact*"
                    SupplierSourceId.MainContact.FirstAndLastName
                        no label
                        display as text
                    visible when (not PrimaryContactExists)
                        PurchasingContact
                            label is "PrimaryInternalContact"
                            select is AttachEmployeesToContract
                paragraph
                    visible when (ProposedContractAnyStatus)
                        visible when (ProposedSupplierNameEntered)
                            visible when (not SupplierEntered)
                                single column
                                    ProposedSupplierName
                                        display as text
                    visible when (SupplierEntered)
                        single column
                            button of "ViewSupplier"
                                link is SupplierNav
                                display as link
                visible when (HasManualTolerances)
                    display as text
                        paragraph
                            text of "ManualTolerances:"
                                bold
                            DerivedToleranceAmount
                                label is "Amount"
                            visible when (ContractSubClassificationEntered)
                                ContractSubclassification.Connector
                                    no label
                            visible when (not ContractSubClassificationEntered)
                                ContractClassification.Connector
                                    no label
                            DerivedTolerancePercent
                                label is "Percent"
        single column
            Description
                use text area
        visible when (DraftOrNew)
            two column distributed
                column1
                    ContractType
                        label is "ContractType*"
                        select is BuyerContractTypesSelect
                    ContractSubtype
                        select is BuyerContractSubtypeSelect
                column2
                    ContractClassification
                        label is "ContractClassification*"
                        select is BuyerContractClassificationSelect
                    ContractSubclassification
                        select is BuyerContractSubclassificationSelect
        visible when (not DraftOrNew)
            display as text
                two column distributed
                    column1
                        ContractType
                            label is "ContractType*"
                        ContractSubtype
                    column2
                        ContractClassification
                            label is "ContractClassification*"
                        ContractSubclassification
        two column distributed
            paragraph
                visible when (CanUpdateDates)
                    EffectiveDate
                    ExpirationDate
                    ContractReviewDate
                visible when (not CanUpdateDates)
                    EffectiveDate
                        display as text
                    ExpirationDate
                        display as text
                    ContractReviewDate
                        label is "ReviewDate"
                        display as text
                    button of "ManageDateChanges"
                        visible when (CanUseUpdateDatesAction)
                        link is DateUpdates
                        display as link
            paragraph
                visible when (CapitatedContract)
                    text of "CapitatedContract"
                    visible when (not HasCapitatedProcedures)
                        CapitatedComponentsOnly
                CurrencyCode
                CurrencyCode.Description
                    no label
                    display as text
        four column distributed
            column1
                paragraph
                    visible when (not PricingManagerRoleOnlyExists)
                        visible when (not MultiTierDistributorContract)
                            visible when (not CapitatedContract)
                                visible when (DraftOrAddendumOrAmendmentOrNew)
                                    ManufacturerOrDistributor.ManufacturerContract
                                visible when (not DraftOrAddendumOrAmendmentOrNew)
                                    ManufacturerOrDistributor.ManufacturerContract
                                        display as text
                    button of "ViewDistributorContracts"
                        visible when (HasDistributorContract)
                        link is DistributorContractLink
                        display as link
                RenewalContract
            column2
                paragraph
                    visible when (not PricingManagerRoleOnlyExists)
                        visible when (not MultiTierDistributorContract)
                            visible when (not CapitatedContract)
                                visible when (DraftOrAddendumOrAmendmentOrNew)
                                    ManufacturerOrDistributor.DistributorContract
                                visible when (not DraftOrAddendumOrAmendmentOrNew)
                                    ManufacturerOrDistributor.DistributorContract
                                        display as text
                        visible when (MultiTierDistributorContract)
                            text of "MultTierDistributorContract"
                                bold
                ContractToHaveSubcontractors
            column3
                GPONegotiated
                visible when (ContractSourceIsSupplier)
                    SupplierOriginatedContract
                        display as text
                visible when (not ContractSourceIsSupplier)
                    SupplierOriginatedContract
            column4
                visible when (GPONegotiated)
                    paragraph
                        GPOSupplier.Supplier
                            label is "GPOSupplier"
                            select is GPOSuppliersSelect
                        GPOSupplier.Supplier.SupplierName
                            no label
                            display as text
                    paragraph
                        GroupPurchasingOrganization.Vendor
                            label is "GPOVendor"
                        GroupPurchasingOrganization.Vendor.VendorName
                            no label
                            display as text
                visible when (not GPONegotiated)
                    SourcingEligible
                        label is "EligibleForEventCreation"
                visible when (CanUseClinicalContractLocations)
                    EnableClinicalSystemUseLocations
        two column distributed
            column1
                paragraph
                    visible when (DerivedUseIDMMessage entered)
                        DerivedUseIDMMessage
                            no label
                            display as text
                    visible when (not HasIDMDocument)
                        visible when (TemplateOrDocumentExists)
                            LatestDocumentRevisionRel.Attachment.Title
                                label is "Document"
                                display as text
                    visible when (not HasIDMDocument)
                        visible when (HasDocumentRevisionFile)
                            button of icon.download
                                view LatestDocumentRevisionRel.Attachment.File
                    visible when (HasIDMDocument)
                        button of "OpenContractDocument"
                            link is external "<DerivedIDMDocumentLink>"
                                lazy url retrieval
                            display as link
                paragraph
                    visible when (ContractClassification entered)
                        visible when (ContractSubclassification entered)
                            visible when (ContractSubclassification.UseIDM)
                                ContractDocumentIDMTemplate
                                    select is ContractIDMTemplate
                                    raise yellow alert when (ShowNoIDMTemplateWarning)
                                        mouse over text is "<DerivedNoIDMTemplateWarningMessage>"
                                button of "<ContractDocumentIDMTemplate.Name>"
                                    link is external "<ContractDocumentIDMTemplate.RetrieveUrl>"
                                        lazy url retrieval
                                    display as link
                            visible when (not ContractSubclassification.UseIDM)
                                ContractDocumentTemplate
                                ContractDocumentTemplate.ContractDocumentTemplateGroup.Title
                                    no label
                                    display as text
                        visible when (ContractSubclassification not entered)
                            visible when (ContractClassification.UseIDM)
                                ContractDocumentIDMTemplate
                                    select is ContractIDMTemplate
                                    raise yellow alert when (ShowNoIDMTemplateWarning)
                                        mouse over text is "<DerivedNoIDMTemplateWarningMessage>"
                                button of "<ContractDocumentIDMTemplate.Name>"
                                    link is external "<ContractDocumentIDMTemplate.RetrieveUrl>"
                                        lazy url retrieval
                                    display as link
                            visible when (not ContractClassification.UseIDM)
                                ContractDocumentTemplate
                                ContractDocumentTemplate.ContractDocumentTemplateGroup.Title
                                    no label
                                    display as text
                    visible when (ContractClassification not entered)
                        ContractDocumentTemplate
                        ContractDocumentTemplate.ContractDocumentTemplateGroup.Title
                            no label
                            display as text
                    button of "ContractVersions"
                        visible when (NonRedliningVersions)
                        link is ContractVersion
                        display as link
                    button of "ContractVersions"
                        visible when (RedliningVersions)
                        link is ContractVersions
                        display as link
                    button of "DocumentManagement"
                        visible when (DisplayDocumentMgmtButton)
                        link is external "<DerivedDocMgmtSystemURL>"
                        display as link
                visible when (CanSetAllowChangeOrder)
                    visible when (IsNotDistributorAndNotManufacturer)
                        visible when (ClassificationAllowsChangeOrder)
                            AllowChangeOrder
                paragraph
                    YellowAlert
                    text of "DaysBeforeContractExpirationDate"
                        italics
                paragraph
                    RedAlert
                    text of "DaysBeforeContractExpirationDate"
                        italics
                paragraph
                    ProposedTotalContractAmount
                        label is "ProposedTotalAmount"
                    visible when (SubcontractorContract)
                        paragraph
                            DiversityPctOfProposedTotal
                                label is "SubcontractorDiversityPercent_ofProposedTotal"
                            button of "Overview"
                                visible when (HasSubcontractors)
                                link is DiversityBySubcontractors
                                display as link
                paragraph
                    visible when (CanUpdateMaximumAmount)
                        MaximumAmount
                    visible when (not CanUpdateMaximumAmount)
                        MaximumAmount
                            display as text
                    visible when (not ContractTypeAllowsZeroMaxQuantity)
                        TotalLineMaximumAmount
                            display as text
                    visible when (HasChild)
                        TotalChildMaximumAmount
                            display as text
                paragraph
                    visible when (HasAllowances)
                        TotalHeaderAllowances
                            display as text
                        TotalLineAllowances
                            display as text
                        visible when (HasCommittedAllowances)
                            DerivedCommittedAllowanceTotal
                                display as text
                        visible when (MaximumAmountEntered)
                            AllowancePercent
                                label is "AllowancePercentOfLifetimeMax"
                                display as text
                paragraph
                    visible when (UseCommitments)
                        TotalCommitments
                            label is "TotalRemainingCommitments"
                            display as text
                        button of "CommitmentDetails"
                            visible when (DrillCommitmentsExist)
                            link is Commitments
                            display as link
                    visible when (HasPendingCommitments)
                        button of "PendingObligationDetails"
                            visible when (BudgetEditingInformationExists)
                            link is BudgetEditingInformation
                            display as link
            column2
                button of "Evaluations"
                    visible when (CanViewEvalutionsLink)
                    link is EvaluationsNav
                    display as link
                paragraph
                    ParentContract
                        select is NotClosedContracts
                    ParentContract.Name
                        no label
                        display as text
                visible when (CanRemoveHold)
                    paragraph
                        ProcurementReasonCode
                            select is HoldReasonCodes
                        ProcurementReasonCode.Description
                            no label
                            display as text
                visible when (HoldEnteredNotCanRemoveHold)
                    paragraph
                        ProcurementReasonCode
                            display as text
                        ProcurementReasonCode.Description
                            no label
                            display as text
                paragraph
                    visible when (CanDisplayInvoiceAllowedDate)
                        FirstInvoiceAllowedDate
                        LastInvoiceAllowedDate
                    visible when (ClosedDate entered)
                        ClosedDate
                            display as text
                visible when (DisplayTermsNeedToBeNegotiated)
                    paragraph
                        EventTermsNeedToBeNegotiated
                            display as text
                        EventTermsHaveBeenNegotiated
                paragraph
                    SetActiveLineToAmendment
                    visible when (SuppliersCanViewAllContracts)
                        DoNotDisplayToAll
                visible when (ContractExists)
                    display as text
                        paragraph
                            ApprovalStatus
                            NegotiationStatus
                            FinalApprovalStatus
                        paragraph
                            PreviousState
                            ContractSource
                            visible when (ProposedByRequester)
                                ProposalRequester.Name
                                    label is "ProposalRequester"
                                visible when (ProposalRequester.EmailAddress entered)
                                    button of icon.mail
                                        link is "mailto:<ProposalRequester.EmailAddress>"
