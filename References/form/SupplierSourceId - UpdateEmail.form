UpdateEmail is an ActionForm
    action is UpdateEmail
    title is "UpdateEmailAddress"
    disable field options
    Layout
        single column
            visible when (not TransientSendVerificationCodeEmail)
                TransientNewEmailAddress
                    label is "New_Email_Address_(User_Name)"
                visible when (SupplierGroup.RequireEmailConfirmation)
                    TransientConfirmNewEmailAddress
                        label is "ConfirmNewEmailAddress"
                TransientEmailPassword
                    label is "CurrentPassword"
            visible when (TransientSendVerificationCodeEmail)
                TransientNewEmailAddress
                    label is "New_Email_Address_(User_Name)"
                    display only
                visible when (SupplierGroup.RequireEmailConfirmation)
                    TransientConfirmNewEmailAddress
                        label is "ConfirmNewEmailAddress"
                        display only
                TransientEmailPassword
                    label is "CurrentPassword"
                    display only
            visible when (not TransientSendVerificationCodeEmail)
                visible when (DisplayForVerificationEmail)
                    paragraph centered
                        text of "ChangingYourEmailAddressWillRequireVerificationOfTheNewEmailAddress."
                            bold
                            italics
                    paragraph centered
                        text of "UseThe_Send_Verification_CodeButtonAfterEnteringYourNewEmailAddressAndCurrentPassword."
                            bold
                            italics
                    paragraph centered
                        button of "SendVerificationCode"
                            is primary
                            when button pressed
                                TransientStringHolderEmail =  blank
                                refresh DerivedVerificationCodeRequiredEmailChange
                                refresh TransientUserUpdateInitiated
                                refresh TransientSendVerificationCodeEmail
                                refresh TransientNextActionEmail
                                refresh TransientUserVerificationIdEmail
                                refresh TransientUserIdentityEmail
                                refresh TransientStringHolderEmail
                                TransientSendVerificationCodeEmail =  true
                                    when (TransientUserUpdateInitiated)
            visible when (TransientSendVerificationCodeEmail)
                paragraph centered
                    text of "PleaseEnterTheVerificationCodeThatWasSentToTheNewEmailAddressEnteredAbove"
                        bold
                        italics
                visible when (TransientResendVerificationCodeEmail)
                    paragraph centered
                        text of "WeHaveSentANewVerificationCode"
                            header4
                            color of red
                blank line
                paragraph centered
                    TransientVerificationCodeEmail
                        no label
                paragraph centered
                    button of "ResendVerificationCode"
                        display as link
                        is primary
                        when button pressed
                            TransientVerificationCodeResentEmail =  false
                            refresh TransientVerificationCodeResentEmail
                            refresh TransientUserUpdateInitiated
                            refresh TransientUserIdentityEmail
                            refresh TransientUserVerificationIdEmail
                            refresh DerivedResendVerificationCodeEmail
                            refresh TransientResendVerificationCodeEmail
            paragraph centered
                TransientStringHolderEmail
                    no label
                    color of red
                    display as text
            visible when (false)
                DerivedVerificationCodeRequiredEmailChange
                TransientNextActionEmail
                TransientUserVerificationIdEmail
                TransientUserIdentityEmail
                TransientUserUpdateInitiated
                DerivedResendVerificationCodeEmail
                TransientSendVerificationCodeEmail
                TransientVerificationCodeResentEmail
